<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Proyecto 10 - Gestión de Memoria Física: Memoria de Video en Modo Texto</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Proyecto 10 - Gestión de Memoria Física
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Aprendiendo Sistemas Operativos</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Buscar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Página&#160;principal</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Páginas&#160;relacionadas</span></a></li>
      <li><a href="../../modules.html"><span>Módulos</span></a></li>
      <li><a href="../../annotated.html"><span>Estructuras&#160;de&#160;Datos</span></a></li>
      <li><a href="../../files.html"><span>Archivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Estructuras de Datos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Archivos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>&apos;defines&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Grupos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Páginas</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Memoria de Video en Modo Texto </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Autor</dt><dd>Erwin Meza Vega <a href="#" onclick="location.href='mai'+'lto:'+'eme'+'za'+'v@g'+'ma'+'il.'+'co'+'m'; return false;">emeza<span style="display: none;">.nosp@m.</span>v@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a></dd></dl>
<p><a class="el" href="../../index.html#project_start">Información del Proyecto</a> : Memoria de Video en Modo Texto</p>
<p>La memoria de video en modo texto a color (25 líneas de 80 caracteres cada una) se encuentra mapeada en memoria a la dirección 0xB8000, y ocupa 32 KB de memoria. Cada carácter en que se muestra en la pantalla ocupa 2 bytes en la memoria de video (un word): un byte contiene el código ASCII del carácter, y el otro byte contiene los atributos de color de texto y color de fondo del carácter. A su vez este byte se subdivide en:</p>
<pre class="fragment">    7  6  5  4  3  2  1  0    
   +-----------------------+
   |I |B |B |B |I |F |F |F |
   +-----------------------+
   Los bits F correspondel al color del texto (Foreground).
   Los bits B corresponden al color de fondo (Background).
   El bit I corresponde a la intensidad del color de fondo (0 = oscuro,
   1 = claro) o del color del texto.</pre><p>De esta forma, para mostrar un carácter en la esquina superior de la pantalla (línea 0, carácter 0) se deberá escribir un word (2 bytes) en la dirección de memoria 0xB8000. El primer byte de este word será el código ascii a mostrar, y los siguientes bytes representarán el color de texto y de fondo del carácter.</p>
<p>El siguiente word (ubicado en la dirección de memoria 0xB8002) corresponde al segundo carácter en la pantalla, y así sucesivamente.</p>
<p>Los colores válidos se muestran en la siguiente tabla : </p>
<pre class="fragment">Valor  Color   Valor   Color
0      black   8       dark gray
1      blue    9       bright blue
2      green   10      bright green
3      cyan    11      bright cyan
4      red     12      pink
5      magenta 13      bright magenta
6      brown   14      yellow
7     white    15      bright white</pre><p>Los colores 0-15 son válidos para el color de texto. Sin embargo para el fondo solo es posible utilizar los colores del 0 al 7,. Los colores de fondo 8 al 15 en algunas tarjetas causan el efecto 'blink' (parpadeo) del texto.</p>
<p>Por ejemplo, para imprimir el carácter 'A', (al cual le corresponde el código ASCII 65, 0x41 en hexadecimal) con color blanco sobre fondo negro en la esquina superior de la pantalla, se deberá copiar el word 0x0F41 en la dirección de memoria 0xB8000. El byte de atributos 0x0F indica texto blanco (dígito hexa F) sobre fondo negro (dígito hexa 0).</p>
<p>Se puede observar la posición XY de un carácter en la pantalla se puede obtener de la siguiente forma:</p>
<p>Pos_XY = 0xB8000 + ((80*Y) + X) *2</p>
<p>En donde 0xB8000 es la dirección base de la memoria de video (esquina superior izquierda), Y representa la fila, X representa la columna. Se debe multiplicar por 2 debido a que cada carácter en la pantalla en realidad ocupa 2 bytes, uno para el código ascii y otro para los atributos de color de texto y fondo.</p>
<h1><a class="anchor" id="cursor_updating"></a>
Actualización de la Posición del Cursor</h1>
<p>El controlador CRT (controlador de video) cuenta con los siguientes puertos de Entrada y Salida:</p>
<pre class="fragment">Dirección   Descripción
  0x3D4    registro de índice
  0x3D5    registro de control</pre><p>Para programar el microcontrolador CRT, primero se debe escribir en el registro de índice. El valor escrito en este puerto le indica al controlador el parámetro que se desea configurar. Luego se debe escribir en el registro de control el dato requerido.</p>
<p>En el caso de la configuración de la posición del cursor, se debe escribir en los puertos del CRT la posición lineal Pos_XY. Debido a que esta posición requiere 16 bits y a que los puertos de E/S del CRT son de 8 bits (1 byte), se deben escribir primero los 8 bits menos significativos de la posición lineal y luego los 8 bits más significativos. Este proceso se describe a continuaión:</p>
<ol type="1">
<li>Escribir el valor 0x0F (Cursor Location Low) en el registro de índice del CRT (puerto de E/S 0x3D4).</li>
<li>Escribir los 8 bits menos significativos de la posición lineal del cursor al registro de control del CRT (puerto 0x3D5).</li>
<li>Escribir el valor 0x0E (Cursor Location High) en el registro de índice del CRT (puerto de E/S 0x3D4).</li>
<li>Escribir los 8 bits más significativos de la posición lineal del cursor al registro de control del CRT (puerto 0x3D5).</li>
</ol>
<dl class="section see"><dt>Ver también</dt><dd><a href="http://www.osdever.net/FreeVGA/vga/crtcreg.htm">http://www.osdever.net/FreeVGA/vga/crtcreg.htm</a> Puertos (registros) del controlador CRT </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generado por &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
